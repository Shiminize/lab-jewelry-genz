# 3D Customizer Preview Restoration Plan

**Date:** 2025-09-12

## 1. Analysis

The `CustomizerPreviewSection.tsx` component has been visually updated to the Aurora design system, but it has been decoupled from its underlying data and logic. It is currently a static UI shell with hardcoded content, which explains why the interactive customization features are missing.

-   **Current State:** A non-interactive component displaying static text and prices.
-   **Required State:** A dynamic, interactive component that allows users to select materials, stones, and settings, with the price updating in real-time based on their choices.
-   **Data Source:** The necessary data (`PREVIEW_MATERIALS`, `PREVIEW_STONES`, `PREVIEW_SETTINGS`) is available and correctly structured in `/src/components/homepage/customizer-preview/previewData.ts`.
-   **Architectural Compliance (`Claude_Rules.md`):**
    -   The task is of **Moderate-to-Complex** complexity due to the interactive state management.
    -   Since the data is local (`previewData.ts`) and no API calls are needed, a **Service layer is not required**.
    -   The logic is self-contained within this single component. Therefore, the simplest compliant solution is to manage state locally using React hooks (`useState`, `useEffect`) directly within the component, rather than creating a separate, single-use hook file. This adheres to the "simplicity-first" and "avoid over-modularization" principles.

## 2. Restoration Plan

I will reintegrate the dynamic data and state management into the existing Aurora UI of the `CustomizerPreviewSection.tsx` component.

### Step 1: Integrate Data Source
-   **Action:** Import `PREVIEW_MATERIALS`, `PREVIEW_STONES`, and `PREVIEW_SETTINGS` from `./customizer-preview/previewData.ts` at the top of the component file.

### Step 2: Implement State Management
-   **Action:** Inside the component, introduce React state using `useState` to track the user's current selections for material, stone, and setting, as well as the calculated price.
-   **Code:**
    ```javascript
    const [selectedMaterial, setSelectedMaterial] = useState(PREVIEW_MATERIALS[0]);
    const [selectedStone, setSelectedStone] = useState(PREVIEW_STONES[0]);
    const [selectedSetting, setSelectedSetting] = useState(PREVIEW_SETTINGS[0]);
    const [calculatedPrice, setCalculatedPrice] = useState(/* initial price */);
    ```

### Step 3: Implement Dynamic Price Calculation
-   **Action:** Use a `useEffect` hook that triggers whenever `selectedMaterial` or `selectedStone` changes. This hook will recalculate the total price by applying the `priceMultiplier` of the selected options to a base price. The `calculatedPrice` state will be updated with the new value.

### Step 4: Restore Dynamic UI Elements
-   **Materials:** The hardcoded list of metals will be replaced with a dynamic list generated by mapping over the `PREVIEW_MATERIALS` array. Each item will be a button with an `onClick` handler that calls `setSelectedMaterial`.
-   **Stones:** The static stone options will be replaced by dynamically rendering the `PREVIEW_STONES` array, with `onClick` handlers to update the `selectedStone` state.
-   **Settings:** The missing "Setting Style" section will be added. It will dynamically render options from the `PREVIEW_SETTINGS` array to update the `selectedSetting` state.

### Step 5: Update Price Display
-   **Action:** The static price element (`$2,400`) will be replaced to display the `calculatedPrice` state variable, ensuring it's always in sync with user selections.

### Step 6: Maintain Aurora UI Compliance
-   **Action:** All new and modified elements will strictly use the existing Tailwind CSS classes from the Aurora design system to ensure perfect visual consistency. No new or inline styles will be added, with the exception of applying the dynamic background color for the material swatches as specified in the data.

This plan will restore the full functionality of the customizer while preserving the new, polished Aurora design, ensuring the component is both interactive and visually compliant.
