<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 1: Dark Image Fix Validation</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .test-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-item img {
            width: 100%;
            height: 200px;
            object-fit: contain;
            border: 1px solid #e1e5e9;
            border-radius: 4px;
            background: white;
        }
        .status {
            margin-top: 10px;
            padding: 8px;
            border-radius: 4px;
            font-weight: 500;
            text-align: center;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        h1 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        h2 { color: #666; margin-top: 30px; }
    </style>
</head>
<body>
    <h1>üß™ Phase 1: Multi-Format Fallback System Validation</h1>
    <p><strong>Testing the dark image fix with multi-format fallback system</strong></p>

    <h2>üéØ Test Results Summary</h2>
    <div class="status success">
        ‚úÖ File System Validation: 36/36 frames available across 3 formats (webp, avif, png)
    </div>
    <div class="status success">
        ‚úÖ API Endpoint Validation: Assets available with multi-format metadata
    </div>
    <div class="status info">
        üîÑ Image Display Test: Loading samples below...
    </div>

    <h2>üì∏ Sample Frame Tests - Ring Luxury 001 Rose Gold</h2>
    <div class="test-grid">
        <div class="test-item">
            <h3>Frame 0 - WebP (Primary)</h3>
            <img src="/images/products/3d-sequences/ring-luxury-001-rose-gold/0.webp" 
                 alt="Frame 0 WebP" 
                 onload="showSuccess(this)" 
                 onerror="showFallback(this, 'avif')">
            <div class="status info" id="status-0-webp">Loading WebP...</div>
        </div>

        <div class="test-item">
            <h3>Frame 9 - AVIF (Secondary)</h3>
            <img src="/images/products/3d-sequences/ring-luxury-001-rose-gold/9.avif" 
                 alt="Frame 9 AVIF" 
                 onload="showSuccess(this)" 
                 onerror="showFallback(this, 'png')">
            <div class="status info" id="status-9-avif">Loading AVIF...</div>
        </div>

        <div class="test-item">
            <h3>Frame 18 - PNG (Fallback)</h3>
            <img src="/images/products/3d-sequences/ring-luxury-001-rose-gold/18.png" 
                 alt="Frame 18 PNG" 
                 onload="showSuccess(this)" 
                 onerror="showError(this)">
            <div class="status info" id="status-18-png">Loading PNG...</div>
        </div>

        <div class="test-item">
            <h3>Frame 35 - Auto Fallback Test</h3>
            <img src="/images/products/3d-sequences/ring-luxury-001-rose-gold/35.webp" 
                 alt="Frame 35 Auto Fallback" 
                 onload="showSuccess(this)" 
                 onerror="tryFallback(this, 35)">
            <div class="status info" id="status-35-auto">Testing auto-fallback...</div>
        </div>
    </div>

    <h2>üîç Dark Image Analysis</h2>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <p><strong>Expected Result:</strong> All images above should show properly rendered jewelry with:</p>
        <ul>
            <li>‚úÖ Visible rose gold material with proper coloring</li>
            <li>‚úÖ Clear jewelry details and reflections</li>
            <li>‚úÖ No black or dark silhouettes</li>
            <li>‚úÖ Proper lighting and material properties</li>
        </ul>
        <p><strong>If you see dark/black images:</strong> The fallback system will try alternative formats automatically.</p>
    </div>

    <script>
        function showSuccess(img) {
            const statusId = 'status-' + getImageId(img.src);
            const statusEl = document.getElementById(statusId);
            if (statusEl) {
                statusEl.textContent = '‚úÖ Loaded successfully';
                statusEl.className = 'status success';
            }
        }

        function showError(img) {
            const statusId = 'status-' + getImageId(img.src);
            const statusEl = document.getElementById(statusId);
            if (statusEl) {
                statusEl.textContent = '‚ùå Failed to load';
                statusEl.className = 'status error';
            }
        }

        function showFallback(img, nextFormat) {
            const frame = getFrameNumber(img.src);
            const newSrc = `/images/products/3d-sequences/ring-luxury-001-rose-gold/${frame}.${nextFormat}`;
            img.src = newSrc;
            
            const statusId = 'status-' + getImageId(img.src);
            const statusEl = document.getElementById(statusId);
            if (statusEl) {
                statusEl.textContent = `üîÑ Trying ${nextFormat.toUpperCase()}...`;
                statusEl.className = 'status info';
            }
        }

        function tryFallback(img, frame) {
            // Try AVIF first
            img.src = `/images/products/3d-sequences/ring-luxury-001-rose-gold/${frame}.avif`;
            img.onerror = function() {
                // Then try PNG
                img.src = `/images/products/3d-sequences/ring-luxury-001-rose-gold/${frame}.png`;
                img.onerror = function() {
                    showError(img);
                };
            };
            
            const statusEl = document.getElementById('status-35-auto');
            if (statusEl) {
                statusEl.textContent = 'üîÑ Auto-fallback in progress...';
                statusEl.className = 'status info';
            }
        }

        function getImageId(src) {
            const parts = src.split('/');
            const filename = parts[parts.length - 1];
            return filename.replace('.', '-');
        }

        function getFrameNumber(src) {
            const parts = src.split('/');
            const filename = parts[parts.length - 1];
            return filename.split('.')[0];
        }

        // Log test start
        console.log('üß™ Phase 1 Dark Image Fix Validation Started');
        console.log('üìä Testing multi-format fallback system implementation');
    </script>
</body>
</html>